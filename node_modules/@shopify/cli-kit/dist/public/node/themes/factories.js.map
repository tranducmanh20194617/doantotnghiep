{"version":3,"file":"factories.js","sourceRoot":"","sources":["../../../../src/public/node/themes/factories.ts"],"names":[],"mappings":"AACA,OAAO,EAAsC,SAAS,EAAC,MAAM,oCAAoC,CAAA;AAsBjG,MAAM,UAAU,UAAU,CAAC,SAA+B;IACxD,IAAI,CAAC,SAAS;QAAE,OAAM;IAEtB,SAAS,CAAC,UAAU,KAApB,SAAS,CAAC,UAAU,GAAK,KAAK,EAAA;IAC9B,SAAS,CAAC,gBAAgB,KAA1B,SAAS,CAAC,gBAAgB,GAAK,KAAK,EAAA;IAEpC,MAAM,EAAC,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,gBAAgB,EAAC,GAAG,SAAS,CAAA;IAEhE,OAAO;QACL,EAAE;QACF,IAAI;QACJ,UAAU;QACV,gBAAgB;QAChB,IAAI,EAAE,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI;KACtC,CAAA;AACH,CAAC;AAED,MAAM,UAAU,aAAa,CAAC,KAA2B;IACvD,IAAI,CAAC,KAAK;QAAE,OAAM;IAElB,MAAM,EAAC,GAAG,EAAE,QAAQ,EAAC,GAAG,KAAK,CAAA;IAC7B,OAAO,EAAC,GAAG,EAAE,QAAQ,EAAC,CAAA;AACxB,CAAC;AAED,MAAM,UAAU,eAAe,CAAC,KAA2B;IACzD,IAAI,CAAC,KAAK;QAAE,OAAM;IAElB,MAAM,EAAC,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,KAAK,EAAC,GAAG,KAAK,CAAA;IAChD,OAAO,EAAC,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,KAAK,EAAC,CAAA;AAC3C,CAAC;AAED,MAAM,UAAU,sBAAsB,CACpC,kBAA8C,EAC9C,MAAqB;IAErB,MAAM,OAAO,GAAa,EAAE,CAAA;IAC5B,IAAI,CAAC,kBAAkB;QAAE,OAAO,OAAO,CAAA;IAEvC,kBAAkB,CAAC,OAAO,CAAC,CAAC,UAAU,EAAE,KAAK,EAAE,EAAE;QAC/C,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,CAAA;QAC3B,OAAO,CAAC,IAAI,CAAC;YACX,GAAG,EAAE,KAAK,EAAE,GAAG,IAAI,EAAE;YACrB,OAAO,EAAE,UAAU,CAAC,IAAI,KAAK,GAAG;YAChC,MAAM,EAAE,UAAU,CAAC,IAAI,CAAC,MAAM,IAAI,EAAE;YACpC,KAAK,EAAE,UAAU,CAAC,IAAI,CAAC,KAAK;YAC5B,SAAS,EAAE,SAAS,CAAC,MAAM;SAC5B,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;IACF,OAAO,OAAO,CAAA;AAChB,CAAC","sourcesContent":["import {AssetParams} from './api.js'\nimport {Result, Checksum, Theme, ThemeAsset, Operation} from '@shopify/cli-kit/node/themes/types'\n\ninterface RemoteThemeResponse {\n  id: number\n  name: string\n  role: string\n  createdAtRuntime?: boolean\n  processing?: boolean\n}\n\ninterface RemoteAssetResponse {\n  key: string\n  checksum: string\n  attachment: string\n  value: string\n}\n\nexport interface RemoteBulkUploadResponse {\n  body: {asset?: RemoteAssetResponse; errors?: {asset: string[]}}\n  code: number\n}\n\nexport function buildTheme(themeJson?: RemoteThemeResponse): Theme | undefined {\n  if (!themeJson) return\n\n  themeJson.processing ??= false\n  themeJson.createdAtRuntime ??= false\n\n  const {id, name, role, processing, createdAtRuntime} = themeJson\n\n  return {\n    id,\n    name,\n    processing,\n    createdAtRuntime,\n    role: role === 'main' ? 'live' : role,\n  }\n}\n\nexport function buildChecksum(asset?: RemoteAssetResponse): Checksum | undefined {\n  if (!asset) return\n\n  const {key, checksum} = asset\n  return {key, checksum}\n}\n\nexport function buildThemeAsset(asset?: RemoteAssetResponse): ThemeAsset | undefined {\n  if (!asset) return\n\n  const {key, checksum, attachment, value} = asset\n  return {key, checksum, attachment, value}\n}\n\nexport function buildBulkUploadResults(\n  bulkUploadResponse: RemoteBulkUploadResponse[],\n  assets: AssetParams[],\n): Result[] {\n  const results: Result[] = []\n  if (!bulkUploadResponse) return results\n\n  bulkUploadResponse.forEach((bulkUpload, index) => {\n    const asset = assets[index]\n    results.push({\n      key: asset?.key || '',\n      success: bulkUpload.code === 200,\n      errors: bulkUpload.body.errors || {},\n      asset: bulkUpload.body.asset,\n      operation: Operation.Upload,\n    })\n  })\n  return results\n}\n"]}