{"version":3,"file":"TextInput.js","sourceRoot":"","sources":["../../../../../src/private/node/ui/components/TextInput.tsx"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-nested-ternary */\nimport {shouldDisplayColors} from '../../../../public/node/output.js'\nimport React, {useEffect, useState} from 'react'\nimport {Text, useInput} from 'ink'\nimport chalk from 'chalk'\nimport figures from 'figures'\nimport type {FunctionComponent} from 'react'\n\ninterface TextInputProps {\n  defaultValue?: string\n  value: string\n  onChange: (value: string) => void\n  color?: string\n  password?: boolean\n  focus?: boolean\n  placeholder?: string\n  noColor?: boolean\n}\n\nconst TextInput: FunctionComponent<TextInputProps> = ({\n  value: originalValue,\n  defaultValue = '',\n  onChange,\n  placeholder = '',\n  noColor = !shouldDisplayColors(),\n  color = noColor ? undefined : 'cyan',\n  password = false,\n  focus = true,\n}: TextInputProps) => {\n  const [cursorOffset, setCursorOffset] = useState((originalValue || '').length)\n\n  // if the updated value is shorter than the last one we need to reset the cursor\n  useEffect(() => {\n    setCursorOffset((previousOffset) => {\n      const newValue = originalValue || ''\n\n      if (previousOffset > newValue.length - 1) {\n        return newValue.length\n      }\n\n      return previousOffset\n    })\n  }, [originalValue])\n\n  const value = password ? '*'.repeat(originalValue.length) : originalValue\n  let renderedValue\n\n  const renderPlaceholder = (value: string) => {\n    return chalk.inverse(value[0]) + chalk.dim(value.slice(1))\n  }\n\n  const cursorChar = figures.square\n  const defaultCursor = <Text backgroundColor={color}>{cursorChar}</Text>\n\n  const placeholderText = defaultValue.length > 0 ? defaultValue : placeholder.length > 0 ? placeholder : ''\n\n  const renderedPlaceholder = placeholderText.length > 0 ? renderPlaceholder(placeholderText) : defaultCursor\n\n  // render cursor\n  renderedValue = value\n    .split('')\n    .map((char, index) => {\n      if (index === cursorOffset) {\n        return noColor ? cursorChar : chalk.inverse(char)\n      } else {\n        return char\n      }\n    })\n    .join('')\n\n  if (cursorOffset === value.length) {\n    renderedValue = (\n      <Text>\n        {renderedValue}\n        {defaultCursor}\n      </Text>\n    )\n  }\n\n  useInput(\n    (input, key) => {\n      if (key.upArrow || key.downArrow || (key.ctrl && input === 'c') || (key.shift && key.tab) || key.return) {\n        return\n      } else if (key.tab) {\n        if (originalValue.length === 0 && placeholderText) {\n          onChange(placeholderText)\n          setCursorOffset(placeholderText.length)\n          return\n        }\n      }\n\n      let nextCursorOffset = cursorOffset\n      let nextValue = originalValue\n\n      if (key.leftArrow) {\n        if (cursorOffset > 0) {\n          nextCursorOffset--\n        }\n      } else if (key.rightArrow) {\n        if (cursorOffset < originalValue.length) {\n          nextCursorOffset++\n        }\n      } else if (key.backspace || key.delete) {\n        if (cursorOffset > 0) {\n          nextValue = originalValue.slice(0, cursorOffset - 1) + originalValue.slice(cursorOffset, originalValue.length)\n          nextCursorOffset--\n        }\n      } else {\n        nextValue =\n          originalValue.slice(0, cursorOffset) + input + originalValue.slice(cursorOffset, originalValue.length)\n        nextCursorOffset += input.length\n      }\n\n      setCursorOffset(nextCursorOffset)\n\n      if (nextValue !== originalValue) {\n        onChange(nextValue)\n      }\n    },\n    {isActive: focus},\n  )\n\n  return <Text color={color}>{value.length > 0 ? renderedValue : renderedPlaceholder}</Text>\n}\n\nexport {TextInput}\n"]}