{"version":3,"file":"fetch-app-from-config-or-select.js","sourceRoot":"","sources":["../../../../src/cli/services/app/fetch-app-from-config-or-select.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,SAAS,EAAC,MAAM,iBAAiB,CAAA;AACzC,OAAO,EAA4B,kBAAkB,EAAC,MAAM,yBAAyB,CAAA;AACrF,OAAO,EAAC,yBAAyB,EAAC,MAAM,eAAe,CAAA;AAEvD,OAAO,EAAC,6BAA6B,EAAC,MAAM,8CAA8C,CAAA;AAC1F,OAAO,EAAC,UAAU,EAAC,MAAM,6BAA6B,CAAA;AAEtD,MAAM,CAAC,KAAK,UAAU,0BAA0B,CAC9C,GAA8B,EAC9B,uBAAuB,GAAG,6BAA6B,EAAE;IAEzD,IAAI,eAAe,CAAA;IACnB,IAAI,kBAAkB,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE;QACzC,MAAM,MAAM,GAAG,GAAG,CAAC,aAAa,CAAC,SAAS,CAAA;QAC1C,eAAe,GAAG,MAAM,uBAAuB,CAAC,SAAS,CAAC;YACxD,EAAE,EAAE,MAAM;YACV,MAAM;YACN,cAAc,EAAE,GAAG,CAAC,aAAa,CAAC,eAAe,IAAI,GAAG;SACzD,CAAC,CAAA;QACF,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,YAAY,GAAG,yBAAyB,CAAC,MAAM,CAAC,CAAA;YACtD,MAAM,IAAI,UAAU,CAAC,YAAY,CAAC,OAAO,EAAE,YAAY,CAAC,UAAU,CAAC,CAAA;SACpE;KACF;SAAM;QACL,eAAe,GAAG,MAAM,SAAS,EAAE,CAAA;KACpC;IACD,OAAO,eAAe,CAAA;AACxB,CAAC","sourcesContent":["import {selectApp} from './select-app.js'\nimport {AppConfigurationInterface, isCurrentAppSchema} from '../../models/app/app.js'\nimport {InvalidApiKeyErrorMessage} from '../context.js'\nimport {OrganizationApp} from '../../models/organization.js'\nimport {selectDeveloperPlatformClient} from '../../utilities/developer-platform-client.js'\nimport {AbortError} from '@shopify/cli-kit/node/error'\n\nexport async function fetchAppFromConfigOrSelect(\n  app: AppConfigurationInterface,\n  developerPlatformClient = selectDeveloperPlatformClient(),\n): Promise<OrganizationApp> {\n  let organizationApp\n  if (isCurrentAppSchema(app.configuration)) {\n    const apiKey = app.configuration.client_id\n    organizationApp = await developerPlatformClient.appFromId({\n      id: apiKey,\n      apiKey,\n      organizationId: app.configuration.organization_id ?? '0',\n    })\n    if (!organizationApp) {\n      const errorMessage = InvalidApiKeyErrorMessage(apiKey)\n      throw new AbortError(errorMessage.message, errorMessage.tryMessage)\n    }\n  } else {\n    organizationApp = await selectApp()\n  }\n  return organizationApp\n}\n"]}