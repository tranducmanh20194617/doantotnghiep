{"version":3,"file":"partners-client.js","sourceRoot":"","sources":["../../../../src/cli/utilities/developer-platform-client/partners-client.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,cAAc,EAAgD,MAAM,iCAAiC,CAAA;AAC7G,OAAO,EACL,+BAA+B,GAGhC,MAAM,4CAA4C,CAAA;AAEnD,OAAO,EAAC,8BAA8B,EAAkB,MAAM,uDAAuD,CAAA;AACrH,OAAO,EAAC,yBAAyB,EAAE,eAAe,EAAE,mBAAmB,EAAC,MAAM,oCAAoC,CAAA;AAQlH,OAAO,EACL,iCAAiC,GAGlC,MAAM,sDAAsD,CAAA;AAC7D,OAAO,EACL,qBAAqB,GAGtB,MAAM,yCAAyC,CAAA;AAChD,OAAO,EAEL,4BAA4B,GAE7B,MAAM,mCAAmC,CAAA;AAC1C,OAAO,EAAC,SAAS,EAAsC,MAAM,iCAAiC,CAAA;AAC9F,OAAO,EACL,uBAAuB,GAGxB,MAAM,iDAAiD,CAAA;AACxD,OAAO,EACL,oBAAoB,GAGrB,MAAM,uCAAuC,CAAA;AAC9C,OAAO,EACL,0BAA0B,GAG3B,MAAM,gDAAgD,CAAA;AACvD,OAAO,EACL,sBAAsB,GAGvB,MAAM,2CAA2C,CAAA;AAClD,OAAO,EACL,gBAAgB,GAGjB,MAAM,wCAAwC,CAAA;AAC/C,OAAO,EAEL,kCAAkC,GAEnC,MAAM,0CAA0C,CAAA;AACjD,OAAO,EACL,uBAAuB,GAGxB,MAAM,4CAA4C,CAAA;AACnD,OAAO,EACL,oBAAoB,GAGrB,MAAM,wCAAwC,CAAA;AAC/C,OAAO,EAAC,UAAU,EAAwC,MAAM,kCAAkC,CAAA;AAClG,OAAO,EACL,oBAAoB,GAGrB,MAAM,yCAAyC,CAAA;AAChD,OAAO,EAAC,qBAAqB,EAA8B,MAAM,+BAA+B,CAAA;AAChG,OAAO,EAGL,yBAAyB,GAC1B,MAAM,0CAA0C,CAAA;AACjD,OAAO,EAA0B,mBAAmB,EAAC,MAAM,gDAAgD,CAAA;AAC3G,OAAO,EAA8C,cAAc,EAAC,MAAM,0CAA0C,CAAA;AACpH,OAAO,EAGL,4BAA4B,GAC7B,MAAM,uDAAuD,CAAA;AAC9D,OAAO,EAAwC,eAAe,EAAC,MAAM,kCAAkC,CAAA;AACvG,OAAO,EAAC,uBAAuB,EAA2B,MAAM,2CAA2C,CAAA;AAC3G,OAAO,EACL,iCAAiC,GAGlC,MAAM,8CAA8C,CAAA;AAErD,OAAO,EAGL,2BAA2B,GAC5B,MAAM,yDAAyD,CAAA;AAChE,OAAO,EAGL,wBAAwB,GACzB,MAAM,sDAAsD,CAAA;AAC7D,OAAO,EAGL,yBAAyB,GAC1B,MAAM,wDAAwD,CAAA;AAC/D,OAAO,EACL,4BAA4B,GAI7B,MAAM,+CAA+C,CAAA;AACtD,OAAO,EACL,0BAA0B,GAG3B,MAAM,qCAAqC,CAAA;AAC5C,OAAO,EAAC,UAAU,EAAC,MAAM,qCAAqC,CAAA;AAC9D,OAAO,EAAC,UAAU,EAAC,MAAM,6BAA6B,CAAA;AACtD,OAAO,EACL,iCAAiC,EAEjC,eAAe,GAChB,MAAM,oCAAoC,CAAA;AAE3C,OAAO,EAAC,2BAA2B,EAAC,MAAM,+BAA+B,CAAA;AAEzE,mGAAmG;AACnG,8DAA8D;AAC9D,MAAM,SAAS,GAAG,2CAA2C,CAAA;AAC7D,MAAM,kBAAkB,GAAG,oDAAoD,CAAA;AAE/E,SAAS,UAAU,CACjB,GAAiB,EACjB,IAAY,EACZ,YAAY,GAAG,IAAI,EACnB,WAAsB;IAEtB,IAAI,YAAY,EAAE;QAChB,OAAO;YACL,GAAG,EAAE,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;YACzB,KAAK,EAAE,GAAG,IAAI,EAAE;YAChB,MAAM,EAAE,qBAAqB;YAC7B,KAAK,EAAE,CAAC,8BAA8B,CAAC;YACvC,qBAAqB,EAAE,WAAW,IAAI,EAAE;YACxC,IAAI,EAAE,WAAW;SAClB,CAAA;KACF;SAAM;QACL,OAAO;YACL,GAAG,EAAE,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;YACzB,KAAK,EAAE,GAAG,IAAI,EAAE;YAChB,MAAM,EAAE,SAAS;YACjB,KAAK,EAAE,CAAC,kBAAkB,CAAC;YAC3B,qBAAqB,EAAE,EAAE;YACzB,IAAI,EAAE,WAAW;SAClB,CAAA;KACF;AACH,CAAC;AAED,MAAM,OAAO,cAAc;IAKzB,YAAY,OAAyB;QAJ9B,8BAAyB,GAAG,KAAK,CAAA;QACjC,yBAAoB,GAAG,KAAK,CAAA;QAIjC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAA;IACzB,CAAC;IAED,KAAK,CAAC,OAAO;QACX,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,IAAI,UAAU,EAAE,EAAE;gBAChB,MAAM,IAAI,KAAK,CAAC,2EAA2E,CAAC,CAAA;aAC7F;YACD,MAAM,KAAK,GAAG,MAAM,2BAA2B,EAAE,CAAA;YACjD,IAAI,CAAC,QAAQ,GAAG;gBACd,KAAK;gBACL,WAAW,EAAE,EAAC,IAAI,EAAE,gBAAgB,EAAC;aACtC,CAAA;YACD,MAAM,WAAW,GAAG,MAAM,8BAA8B,CAAC,IAAI,CAAC,CAAA;YAC9D,IAAI,CAAC,QAAQ,GAAG,EAAC,KAAK,EAAE,WAAW,EAAC,CAAA;SACrC;QACD,OAAO,IAAI,CAAC,QAAQ,CAAA;IACtB,CAAC;IAED,KAAK,CAAC,OAAO,CAAI,KAAa,EAAE,YAA0C,SAAS;QACjF,OAAO,eAAe,CAAC,KAAK,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,EAAE,SAAS,CAAC,CAAA;IAC9D,CAAC;IAED,KAAK,CAAC,KAAK;QACT,OAAO,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,KAAK,CAAA;IACrC,CAAC;IAED,KAAK,CAAC,YAAY;QAChB,MAAM,QAAQ,GAAG,MAAM,2BAA2B,CAAC,EAAE,EAAE,OAAO,CAAC,GAAG,EAAE,EAAC,QAAQ,EAAE,IAAI,EAAC,CAAC,CAAA;QACrF,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,OAAO,EAAE,CAAA;QACpC,IAAI,QAAQ,EAAE;YACZ,OAAO,CAAC,KAAK,GAAG,QAAQ,CAAA;SACzB;QACD,OAAO,OAAO,CAAC,KAAK,CAAA;IACtB,CAAC;IAED,KAAK,CAAC,WAAW;QACf,OAAO,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,WAAW,CAAA;IAC3C,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,EAAC,MAAM,EAAwB;QAC7C,OAAO,yBAAyB,CAAC,MAAM,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,CAAC,CAAA;IAC9D,CAAC;IAED,KAAK,CAAC,aAAa;QACjB,MAAM,MAAM,GAAgC,MAAM,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAA;QACrF,OAAO,MAAM,CAAC,aAAa,CAAC,KAAK,CAAA;IACnC,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,KAAa;QAC3B,MAAM,SAAS,GAAmC,EAAC,EAAE,EAAE,KAAK,EAAC,CAAA;QAC7D,MAAM,MAAM,GAAqC,MAAM,IAAI,CAAC,OAAO,CAAC,0BAA0B,EAAE,SAAS,CAAC,CAAA;QAC1G,OAAO,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;IACtC,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,KAAa;QAC5B,MAAM,MAAM,GAAG,MAAM,eAAe,CAAC,KAAK,EAAE,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAA;QACjE,OAAO;YACL,YAAY,EAAE,MAAM,CAAC,YAAY;YACjC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,KAAK;YACvB,YAAY,EAAE,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW;SAC/C,CAAA;IACH,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,cAAsB,EAAE,IAAa;QACpD,MAAM,MAAM,GAAG,MAAM,eAAe,CAAC,cAAc,EAAE,MAAM,IAAI,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,CAAA;QAChF,OAAO;YACL,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,KAAK;YACvB,YAAY,EAAE,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW;SAC/C,CAAA;IACH,CAAC;IAED,KAAK,CAAC,cAAc,CAAC,KAAa;QAChC,MAAM,SAAS,GAA0C,EAAC,OAAO,EAAE,KAAK,EAAC,CAAA;QACzE,MAAM,MAAM,GAAuC,MAAM,IAAI,CAAC,OAAO,CAAC,4BAA4B,EAAE,SAAS,CAAC,CAAA;QAC9G,OAAO,MAAM,CAAC,uBAAuB,CAAA;IACvC,CAAC;IAED,KAAK,CAAC,sBAAsB,CAAC,KAAa;QACxC,MAAM,SAAS,GAA0C,EAAC,MAAM,EAAE,KAAK,EAAC,CAAA;QACxE,MAAM,MAAM,GAAuC,MAAM,IAAI,CAAC,OAAO,CAAC,iCAAiC,EAAE,SAAS,CAAC,CAAA;QACnH,OAAO,MAAM,CAAC,sBAAsB,CAAA;IACtC,CAAC;IAED,KAAK,CAAC,SAAS,CACb,GAAiB,EACjB,IAAY,EACZ,OAIC;QAED,MAAM,SAAS,GAA4B,UAAU,CAAC,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,YAAY,EAAE,OAAO,EAAE,WAAW,CAAC,CAAA;QAC7G,MAAM,MAAM,GAAyB,MAAM,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAA;QAClF,IAAI,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1C,MAAM,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YACnF,MAAM,IAAI,UAAU,CAAC,MAAM,CAAC,CAAA;SAC7B;QAED,MAAM,KAAK,GAAG,mBAAmB,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAA;QACrE,OAAO,EAAC,GAAG,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE,cAAc,EAAE,GAAG,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAC,CAAA;IAC/E,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,KAAa;QACjC,MAAM,SAAS,GAA6C,EAAC,EAAE,EAAE,KAAK,EAAC,CAAA;QACvE,MAAM,MAAM,GAAqC,MAAM,IAAI,CAAC,OAAO,CAAC,+BAA+B,EAAE,SAAS,CAAC,CAAA;QAC/G,OAAO,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAE,CAAC,MAAM,CAAC,KAAK,CAAA;IACpD,CAAC;IAED,KAAK,CAAC,yBAAyB,CAAC,EAAC,MAAM,EAAwB;QAC7D,MAAM,SAAS,GAA+C,EAAC,MAAM,EAAC,CAAA;QACtE,OAAO,IAAI,CAAC,OAAO,CAAC,iCAAiC,EAAE,SAAS,CAAC,CAAA;IACnE,CAAC;IAED,KAAK,CAAC,WAAW,CAAC,MAAc;QAC9B,MAAM,SAAS,GAA8B,EAAC,MAAM,EAAC,CAAA;QACrD,OAAO,IAAI,CAAC,OAAO,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAA;IAClD,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,KAA+B;QACnD,OAAO,IAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAA;IAClD,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,KAA+B;QACnD,OAAO,IAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAA;IAClD,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,EAAC,MAAM,EAAwB;QACpD,MAAM,SAAS,GAAmC,EAAC,MAAM,EAAC,CAAA;QAC1D,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAA8B,qBAAqB,EAAE,SAAS,CAAC,CAAA;QAChG,MAAM,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,gBAAgB,CAAA;QAC3C,OAAO;YACL,GAAG,OAAO;YACV,iBAAiB,EAAE,OAAO,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE;gBACvD,OAAO;oBACL,GAAG,GAAG;oBACN,MAAM,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC,CAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAY,CAAC,CAAC,CAAC,EAAE;iBAC7D,CAAA;YACH,CAAC,CAAC;SACH,CAAA;IACH,CAAC;IAED,KAAK,CAAC,iBAAiB;QACrB,OAAO,IAAI,CAAC,OAAO,CAAC,iCAAiC,CAAC,CAAA;IACxD,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,KAA+B;QACnD,OAAO,IAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAA;IAClD,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,cAAyC;QAC7D,OAAO,IAAI,CAAC,OAAO,CAAC,4BAA4B,EAAE,cAAc,CAAC,CAAA;IACnE,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,WAA+B;QAC1C,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,WAAW,CAAC,CAAA;IAC7C,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,KAA0B;QACtC,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,CAAA;IACxC,CAAC;IAED,KAAK,CAAC,uBAAuB,CAAC,KAAuC;QACnE,OAAO,IAAI,CAAC,OAAO,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAA;IACrD,CAAC;IAED,KAAK,CAAC,kBAAkB,CAAC,KAAqC;QAC5D,OAAO,IAAI,CAAC,OAAO,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAA;IACxD,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,KAAa,EAAE,UAAkB;QACnD,MAAM,SAAS,GAAoC,EAAC,KAAK,EAAE,UAAU,EAAC,CAAA;QACtE,OAAO,IAAI,CAAC,OAAO,CAAC,sBAAsB,EAAE,SAAS,CAAC,CAAA;IACxD,CAAC;IAED,KAAK,CAAC,sBAAsB,CAC1B,KAAyC;QAEzC,OAAO,IAAI,CAAC,OAAO,CAAC,kCAAkC,EAAE,KAAK,CAAC,CAAA;IAChE,CAAC;IAED,KAAK,CAAC,cAAc,CAAC,KAAkC;QACrD,OAAO,IAAI,CAAC,OAAO,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAA;IACrD,CAAC;IAED,KAAK,CAAC,iBAAiB,CAAC,KAAiC;QACvD,OAAO,IAAI,CAAC,OAAO,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAA;IACvD,CAAC;IAED,KAAK,CAAC,WAAW;QACf,OAAO,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAA;IAC1C,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,KAA6B;QACxC,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,KAAK,CAAC,CAAA;IAC5C,CAAC;IAED,KAAK,CAAC,oBAAoB,CAAC,KAAoC;QAC7D,OAAO,IAAI,CAAC,OAAO,CAAC,4BAA4B,EAAE,KAAK,CAAC,CAAA;IAC1D,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,KAA0B;QACzC,OAAO,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,KAAK,CAAC,CAAA;IAC7C,CAAC;IAED,KAAK,CAAC,kBAAkB;QACtB,OAAO,IAAI,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAA;IAC9C,CAAC;IAED,KAAK,CAAC,sBAAsB,CAAC,KAA2C;QACtE,MAAM,QAAQ,GAAsC,MAAM,IAAI,CAAC,OAAO,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAA;QAC1G,OAAO,QAAQ,CAAC,UAAU,CAAA;IAC5B,CAAC;IAED,KAAK,CAAC,mBAAmB,CAAC,KAAwC;QAChE,MAAM,QAAQ,GAAmC,MAAM,IAAI,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAA;QACpG,OAAO,QAAQ,CAAC,UAAU,CAAA;IAC5B,CAAC;IAED,KAAK,CAAC,oBAAoB,CAAC,KAAoC;QAC7D,OAAO,IAAI,CAAC,OAAO,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAA;IACvD,CAAC;IAED,sBAAsB,CAAC,KAAa;QAClC,OAAO,KAAK,CAAC,WAAW,EAAE,CAAA;IAC5B,CAAC;CACF","sourcesContent":["import {CreateAppQuery, CreateAppQuerySchema, CreateAppQueryVariables} from '../../api/graphql/create_app.js'\nimport {\n  AllDevStoresByOrganizationQuery,\n  AllDevStoresByOrganizationQueryVariables,\n  AllDevStoresByOrganizationSchema,\n} from '../../api/graphql/all_dev_stores_by_org.js'\nimport {ActiveAppVersion, DeveloperPlatformClient, Paginateable} from '../developer-platform-client.js'\nimport {fetchCurrentAccountInformation, PartnersSession} from '../../../cli/services/context/partner-account-info.js'\nimport {fetchAppDetailsFromApiKey, fetchOrgAndApps, filterDisabledFlags} from '../../../cli/services/dev/fetch.js'\nimport {\n  MinimalAppIdentifiers,\n  MinimalOrganizationApp,\n  Organization,\n  OrganizationApp,\n  OrganizationStore,\n} from '../../models/organization.js'\nimport {\n  AllAppExtensionRegistrationsQuery,\n  AllAppExtensionRegistrationsQueryVariables,\n  AllAppExtensionRegistrationsQuerySchema,\n} from '../../api/graphql/all_app_extension_registrations.js'\nimport {\n  ActiveAppVersionQuery,\n  ActiveAppVersionQuerySchema,\n  ActiveAppVersionQueryVariables,\n} from '../../api/graphql/app_active_version.js'\nimport {\n  ExtensionUpdateDraftInput,\n  ExtensionUpdateDraftMutation,\n  ExtensionUpdateSchema,\n} from '../../api/graphql/update_draft.js'\nimport {AppDeploy, AppDeploySchema, AppDeployVariables} from '../../api/graphql/app_deploy.js'\nimport {\n  GenerateSignedUploadUrl,\n  GenerateSignedUploadUrlSchema,\n  GenerateSignedUploadUrlVariables,\n} from '../../api/graphql/generate_signed_upload_url.js'\nimport {\n  ExtensionCreateQuery,\n  ExtensionCreateSchema,\n  ExtensionCreateVariables,\n} from '../../api/graphql/extension_create.js'\nimport {\n  ConvertDevToTestStoreQuery,\n  ConvertDevToTestStoreSchema,\n  ConvertDevToTestStoreVariables,\n} from '../../api/graphql/convert_dev_to_test_store.js'\nimport {\n  FindStoreByDomainQuery,\n  FindStoreByDomainQueryVariables,\n  FindStoreByDomainSchema,\n} from '../../api/graphql/find_store_by_domain.js'\nimport {\n  AppVersionsQuery,\n  AppVersionsQueryVariables,\n  AppVersionsQuerySchema,\n} from '../../api/graphql/get_versions_list.js'\nimport {\n  DevelopmentStorePreviewUpdateInput,\n  DevelopmentStorePreviewUpdateQuery,\n  DevelopmentStorePreviewUpdateSchema,\n} from '../../api/graphql/development_preview.js'\nimport {\n  FindAppPreviewModeQuery,\n  FindAppPreviewModeSchema,\n  FindAppPreviewModeVariables,\n} from '../../api/graphql/find_app_preview_mode.js'\nimport {\n  AppVersionsDiffQuery,\n  AppVersionsDiffSchema,\n  AppVersionsDiffVariables,\n} from '../../api/graphql/app_versions_diff.js'\nimport {AppRelease, AppReleaseSchema, AppReleaseVariables} from '../../api/graphql/app_release.js'\nimport {\n  AppVersionByTagQuery,\n  AppVersionByTagSchema,\n  AppVersionByTagVariables,\n} from '../../api/graphql/app_version_by_tag.js'\nimport {AllOrganizationsQuery, AllOrganizationsQuerySchema} from '../../api/graphql/all_orgs.js'\nimport {\n  SendSampleWebhookSchema,\n  SendSampleWebhookVariables,\n  sendSampleWebhookMutation,\n} from '../../services/webhook/request-sample.js'\nimport {PublicApiVersionsSchema, GetApiVersionsQuery} from '../../services/webhook/request-api-versions.js'\nimport {WebhookTopicsSchema, WebhookTopicsVariables, getTopicsQuery} from '../../services/webhook/request-topics.js'\nimport {\n  MigrateFlowExtensionVariables,\n  MigrateFlowExtensionSchema,\n  MigrateFlowExtensionMutation,\n} from '../../api/graphql/extension_migrate_flow_extension.js'\nimport {UpdateURLsVariables, UpdateURLsSchema, UpdateURLsQuery} from '../../api/graphql/update_urls.js'\nimport {CurrentAccountInfoQuery, CurrentAccountInfoSchema} from '../../api/graphql/current_account_info.js'\nimport {\n  RemoteTemplateSpecificationsQuery,\n  RemoteTemplateSpecificationsSchema,\n  RemoteTemplateSpecificationsVariables,\n} from '../../api/graphql/template_specifications.js'\nimport {ExtensionTemplate} from '../../models/app/template.js'\nimport {\n  TargetSchemaDefinitionQueryVariables,\n  TargetSchemaDefinitionQuerySchema,\n  TargetSchemaDefinitionQuery,\n} from '../../api/graphql/functions/target_schema_definition.js'\nimport {\n  ApiSchemaDefinitionQueryVariables,\n  ApiSchemaDefinitionQuerySchema,\n  ApiSchemaDefinitionQuery,\n} from '../../api/graphql/functions/api_schema_definition.js'\nimport {\n  MigrateToUiExtensionVariables,\n  MigrateToUiExtensionSchema,\n  MigrateToUiExtensionQuery,\n} from '../../api/graphql/extension_migrate_to_ui_extension.js'\nimport {\n  ExtensionSpecificationsQuery,\n  ExtensionSpecificationsQuerySchema,\n  ExtensionSpecificationsQueryVariables,\n  RemoteSpecification,\n} from '../../api/graphql/extension_specifications.js'\nimport {\n  FindOrganizationBasicQuery,\n  FindOrganizationBasicQuerySchema,\n  FindOrganizationBasicVariables,\n} from '../../api/graphql/find_org_basic.js'\nimport {isUnitTest} from '@shopify/cli-kit/node/context/local'\nimport {AbortError} from '@shopify/cli-kit/node/error'\nimport {\n  FunctionUploadUrlGenerateMutation,\n  FunctionUploadUrlGenerateResponse,\n  partnersRequest,\n} from '@shopify/cli-kit/node/api/partners'\nimport {GraphQLVariables} from '@shopify/cli-kit/node/api/graphql'\nimport {ensureAuthenticatedPartners} from '@shopify/cli-kit/node/session'\n\n// this is a temporary solution for editions to support https://vault.shopify.io/gsd/projects/31406\n// read more here: https://vault.shopify.io/gsd/projects/31406\nconst MAGIC_URL = 'https://shopify.dev/apps/default-app-home'\nconst MAGIC_REDIRECT_URL = 'https://shopify.dev/apps/default-app-home/api/auth'\n\nfunction getAppVars(\n  org: Organization,\n  name: string,\n  isLaunchable = true,\n  scopesArray?: string[],\n): CreateAppQueryVariables {\n  if (isLaunchable) {\n    return {\n      org: parseInt(org.id, 10),\n      title: `${name}`,\n      appUrl: 'https://example.com',\n      redir: ['https://example.com/api/auth'],\n      requestedAccessScopes: scopesArray ?? [],\n      type: 'undecided',\n    }\n  } else {\n    return {\n      org: parseInt(org.id, 10),\n      title: `${name}`,\n      appUrl: MAGIC_URL,\n      redir: [MAGIC_REDIRECT_URL],\n      requestedAccessScopes: [],\n      type: 'undecided',\n    }\n  }\n}\n\nexport class PartnersClient implements DeveloperPlatformClient {\n  public supportsAtomicDeployments = false\n  public requiresOrganization = false\n  private _session: PartnersSession | undefined\n\n  constructor(session?: PartnersSession) {\n    this._session = session\n  }\n\n  async session(): Promise<PartnersSession> {\n    if (!this._session) {\n      if (isUnitTest()) {\n        throw new Error('PartnersClient.session() should not be invoked dynamically in a unit test')\n      }\n      const token = await ensureAuthenticatedPartners()\n      this._session = {\n        token,\n        accountInfo: {type: 'UnknownAccount'},\n      }\n      const accountInfo = await fetchCurrentAccountInformation(this)\n      this._session = {token, accountInfo}\n    }\n    return this._session\n  }\n\n  async request<T>(query: string, variables: GraphQLVariables | undefined = undefined): Promise<T> {\n    return partnersRequest(query, await this.token(), variables)\n  }\n\n  async token(): Promise<string> {\n    return (await this.session()).token\n  }\n\n  async refreshToken(): Promise<string> {\n    const newToken = await ensureAuthenticatedPartners([], process.env, {noPrompt: true})\n    const session = await this.session()\n    if (newToken) {\n      session.token = newToken\n    }\n    return session.token\n  }\n\n  async accountInfo(): Promise<PartnersSession['accountInfo']> {\n    return (await this.session()).accountInfo\n  }\n\n  async appFromId({apiKey}: MinimalAppIdentifiers): Promise<OrganizationApp | undefined> {\n    return fetchAppDetailsFromApiKey(apiKey, await this.token())\n  }\n\n  async organizations(): Promise<Organization[]> {\n    const result: AllOrganizationsQuerySchema = await this.request(AllOrganizationsQuery)\n    return result.organizations.nodes\n  }\n\n  async orgFromId(orgId: string): Promise<Organization | undefined> {\n    const variables: FindOrganizationBasicVariables = {id: orgId}\n    const result: FindOrganizationBasicQuerySchema = await this.request(FindOrganizationBasicQuery, variables)\n    return result.organizations.nodes[0]\n  }\n\n  async orgAndApps(orgId: string): Promise<Paginateable<{organization: Organization; apps: MinimalOrganizationApp[]}>> {\n    const result = await fetchOrgAndApps(orgId, await this.session())\n    return {\n      organization: result.organization,\n      apps: result.apps.nodes,\n      hasMorePages: result.apps.pageInfo.hasNextPage,\n    }\n  }\n\n  async appsForOrg(organizationId: string, term?: string): Promise<Paginateable<{apps: MinimalOrganizationApp[]}>> {\n    const result = await fetchOrgAndApps(organizationId, await this.session(), term)\n    return {\n      apps: result.apps.nodes,\n      hasMorePages: result.apps.pageInfo.hasNextPage,\n    }\n  }\n\n  async specifications(appId: string): Promise<RemoteSpecification[]> {\n    const variables: ExtensionSpecificationsQueryVariables = {api_key: appId}\n    const result: ExtensionSpecificationsQuerySchema = await this.request(ExtensionSpecificationsQuery, variables)\n    return result.extensionSpecifications\n  }\n\n  async templateSpecifications(appId: string): Promise<ExtensionTemplate[]> {\n    const variables: RemoteTemplateSpecificationsVariables = {apiKey: appId}\n    const result: RemoteTemplateSpecificationsSchema = await this.request(RemoteTemplateSpecificationsQuery, variables)\n    return result.templateSpecifications\n  }\n\n  async createApp(\n    org: Organization,\n    name: string,\n    options?: {\n      isLaunchable?: boolean\n      scopesArray?: string[]\n      directory?: string\n    },\n  ): Promise<OrganizationApp> {\n    const variables: CreateAppQueryVariables = getAppVars(org, name, options?.isLaunchable, options?.scopesArray)\n    const result: CreateAppQuerySchema = await this.request(CreateAppQuery, variables)\n    if (result.appCreate.userErrors.length > 0) {\n      const errors = result.appCreate.userErrors.map((error) => error.message).join(', ')\n      throw new AbortError(errors)\n    }\n\n    const flags = filterDisabledFlags(result.appCreate.app.disabledFlags)\n    return {...result.appCreate.app, organizationId: org.id, newApp: true, flags}\n  }\n\n  async devStoresForOrg(orgId: string): Promise<OrganizationStore[]> {\n    const variables: AllDevStoresByOrganizationQueryVariables = {id: orgId}\n    const result: AllDevStoresByOrganizationSchema = await this.request(AllDevStoresByOrganizationQuery, variables)\n    return result.organizations.nodes[0]!.stores.nodes\n  }\n\n  async appExtensionRegistrations({apiKey}: MinimalAppIdentifiers): Promise<AllAppExtensionRegistrationsQuerySchema> {\n    const variables: AllAppExtensionRegistrationsQueryVariables = {apiKey}\n    return this.request(AllAppExtensionRegistrationsQuery, variables)\n  }\n\n  async appVersions(apiKey: string): Promise<AppVersionsQuerySchema> {\n    const variables: AppVersionsQueryVariables = {apiKey}\n    return this.request(AppVersionsQuery, variables)\n  }\n\n  async appVersionByTag(input: AppVersionByTagVariables): Promise<AppVersionByTagSchema> {\n    return this.request(AppVersionByTagQuery, input)\n  }\n\n  async appVersionsDiff(input: AppVersionsDiffVariables): Promise<AppVersionsDiffSchema> {\n    return this.request(AppVersionsDiffQuery, input)\n  }\n\n  async activeAppVersion({apiKey}: MinimalAppIdentifiers): Promise<ActiveAppVersion> {\n    const variables: ActiveAppVersionQueryVariables = {apiKey}\n    const result = await this.request<ActiveAppVersionQuerySchema>(ActiveAppVersionQuery, variables)\n    const version = result.app.activeAppVersion\n    return {\n      ...version,\n      appModuleVersions: version.appModuleVersions.map((mod) => {\n        return {\n          ...mod,\n          config: mod.config ? (JSON.parse(mod.config) as object) : {},\n        }\n      }),\n    }\n  }\n\n  async functionUploadUrl(): Promise<FunctionUploadUrlGenerateResponse> {\n    return this.request(FunctionUploadUrlGenerateMutation)\n  }\n\n  async createExtension(input: ExtensionCreateVariables): Promise<ExtensionCreateSchema> {\n    return this.request(ExtensionCreateQuery, input)\n  }\n\n  async updateExtension(extensionInput: ExtensionUpdateDraftInput): Promise<ExtensionUpdateSchema> {\n    return this.request(ExtensionUpdateDraftMutation, extensionInput)\n  }\n\n  async deploy(deployInput: AppDeployVariables): Promise<AppDeploySchema> {\n    return this.request(AppDeploy, deployInput)\n  }\n\n  async release(input: AppReleaseVariables): Promise<AppReleaseSchema> {\n    return this.request(AppRelease, input)\n  }\n\n  async generateSignedUploadUrl(input: GenerateSignedUploadUrlVariables): Promise<GenerateSignedUploadUrlSchema> {\n    return this.request(GenerateSignedUploadUrl, input)\n  }\n\n  async convertToTestStore(input: ConvertDevToTestStoreVariables): Promise<ConvertDevToTestStoreSchema> {\n    return this.request(ConvertDevToTestStoreQuery, input)\n  }\n\n  async storeByDomain(orgId: string, shopDomain: string): Promise<FindStoreByDomainSchema> {\n    const variables: FindStoreByDomainQueryVariables = {orgId, shopDomain}\n    return this.request(FindStoreByDomainQuery, variables)\n  }\n\n  async updateDeveloperPreview(\n    input: DevelopmentStorePreviewUpdateInput,\n  ): Promise<DevelopmentStorePreviewUpdateSchema> {\n    return this.request(DevelopmentStorePreviewUpdateQuery, input)\n  }\n\n  async appPreviewMode(input: FindAppPreviewModeVariables): Promise<FindAppPreviewModeSchema> {\n    return this.request(FindAppPreviewModeQuery, input)\n  }\n\n  async sendSampleWebhook(input: SendSampleWebhookVariables): Promise<SendSampleWebhookSchema> {\n    return this.request(sendSampleWebhookMutation, input)\n  }\n\n  async apiVersions(): Promise<PublicApiVersionsSchema> {\n    return this.request(GetApiVersionsQuery)\n  }\n\n  async topics(input: WebhookTopicsVariables): Promise<WebhookTopicsSchema> {\n    return this.request(getTopicsQuery, input)\n  }\n\n  async migrateFlowExtension(input: MigrateFlowExtensionVariables): Promise<MigrateFlowExtensionSchema> {\n    return this.request(MigrateFlowExtensionMutation, input)\n  }\n\n  async updateURLs(input: UpdateURLsVariables): Promise<UpdateURLsSchema> {\n    return this.request(UpdateURLsQuery, input)\n  }\n\n  async currentAccountInfo(): Promise<CurrentAccountInfoSchema> {\n    return this.request(CurrentAccountInfoQuery)\n  }\n\n  async targetSchemaDefinition(input: TargetSchemaDefinitionQueryVariables): Promise<string | null> {\n    const response: TargetSchemaDefinitionQuerySchema = await this.request(TargetSchemaDefinitionQuery, input)\n    return response.definition\n  }\n\n  async apiSchemaDefinition(input: ApiSchemaDefinitionQueryVariables): Promise<string | null> {\n    const response: ApiSchemaDefinitionQuerySchema = await this.request(ApiSchemaDefinitionQuery, input)\n    return response.definition\n  }\n\n  async migrateToUiExtension(input: MigrateToUiExtensionVariables): Promise<MigrateToUiExtensionSchema> {\n    return this.request(MigrateToUiExtensionQuery, input)\n  }\n\n  toExtensionGraphQLType(input: string) {\n    return input.toUpperCase()\n  }\n}\n"]}